import time

from mydreamz.raft.storage import Storage
from mydreamz.exchanges.exchange import exchange

partner_address = ['127.0.0.1:10001', '127.0.0.1:10002', '127.0.0.1:10003', '127.0.0.1:10004', '127.0.0.1:10005', '127.0.0.1:10006', '127.0.0.1:10007', '127.0.0.1:10008', '127.0.0.1:10009', '127.0.0.1:10010', '127.0.0.1:10011', '127.0.0.1:10012', '127.0.0.1:10013', '127.0.0.1:10014', '127.0.0.1:10015', '127.0.0.1:10016', '127.0.0.1:10017', '127.0.0.1:10018', '127.0.0.1:10019', '127.0.0.1:10020', '127.0.0.1:10021', '127.0.0.1:10022', '127.0.0.1:10023', '127.0.0.1:10024', '127.0.0.1:10025', '127.0.0.1:10026', '127.0.0.1:10027', '127.0.0.1:10028', '127.0.0.1:10029', '127.0.0.1:10030', '127.0.0.1:10031', '127.0.0.1:10032', '127.0.0.1:10033', '127.0.0.1:10034', '127.0.0.1:10035', '127.0.0.1:10036', '127.0.0.1:10037', '127.0.0.1:10038', '127.0.0.1:10039', '127.0.0.1:10040', '127.0.0.1:10041', '127.0.0.1:10042', '127.0.0.1:10043', '127.0.0.1:10044', '127.0.0.1:10045', '127.0.0.1:10046', '127.0.0.1:10047', '127.0.0.1:10048', '127.0.0.1:10049', '127.0.0.1:10050']


if __name__ == '__main__':
    storage = Storage("127.0.0.1:20001", partner_address)
   
    while True:
        for key, value in exchange.items():
            print("{}:{}".format(key, storage.get(key)))
        time.sleep(1)
        
